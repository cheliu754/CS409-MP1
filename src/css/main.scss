$font-sans: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, 'Apple Color Emoji', 'Segoe UI Emoji';

$space-1: 4px;
$space-2: 8px;
$space-3: 12px;
$space-4: 16px;
$space-5: 20px;
$space-6: 24px;
$space-7: 28px;
$space-8: 32px;

$radius-sm: 8px;
$radius-md: 10px;
$radius-lg: 12px;
$radius-xl: 14px;
$radius-pill: 999px;

$timing-fast: .2s ease;
$timing-med: .3s ease;

$shadow: 0 10px 30px rgba(0,0,0,.35);

$colors: (
  brand:   #5a67d8,
  brand2:  #0ea5e9,
  bg:      #0a0f1d,
  text:    #e5e7eb,
  muted:   #9ca3af,
  border:  rgba(255,255,255,.12),
);

$nav-h-lg: 92px;
$nav-h-sm: 64px;
$maxw:     1200px;

/* Breakpoints (min-width) */
$bp: (
  xs: 480px,
  sm: 768px,
  md: 1024px,
  lg: 1280px,
  xl: 1440px,
  xxl: 1920px
);

/* Z-index scale */
$z: (
  navbar: 1000,
  modal:  9000
);

// Helpers
@function c($key) { @return map-get($colors, $key); }

@function clampREM($min, $pref, $max) {
  @return clamp(#{$min}rem, #{$pref}vw, #{$max}rem);
}

@mixin respond($bp-key) {
  @media (max-width: map-get($bp, $bp-key)) { @content; }
}

@mixin container {
  width: min(100% - 32px, #{$maxw});
  margin-inline: auto;
}

@mixin section {
  padding-block: 96px;
  @include respond(sm) { padding-block: 72px; }
}

@mixin glass {
  background: rgba(255,255,255,.05);
  border: 1px solid c(border);
  box-shadow: $shadow;
  backdrop-filter: saturate(120%) blur(10px);
  border-radius: $radius-xl;
}

@mixin focus-ring($color: map-get($colors, brand)) {
  &:focus-visible {
    outline: 2px dashed $color;
    outline-offset: 3px;
  }
}

// Base / Resets
* { box-sizing: border-box; }

html {
  scroll-behavior: smooth;
  scroll-padding-top: $nav-h-sm + 12px;
  --nav-scale: 1;
  overflow-x: hidden;
}

body {
  margin: 0;
  font-family: $font-sans;
  color: c(text);
  background:
    radial-gradient(1200px 600px at 10% 0%, rgba(94,96,206,.12), transparent 60%),
    radial-gradient(1200px 600px at 90% 20%, rgba(14,165,233,.12), transparent 60%),
    c(bg);
}

img, video { max-width: 100%; height: auto; display: block; }

a {
  color: inherit;
  text-decoration: none;
  @include focus-ring(c(brand));
}

h1, h2, h3 { line-height: 1.2; margin: 0 0 $space-3; }
p { color: c(muted); margin: 0 0 $space-4; }

// Navbar
#navbar {
  position: sticky;
  top: 0;
  z-index: map-get($z, navbar);
  height: $nav-h-lg;
  background: rgba(15,23,42,.55);
  border-bottom: 1px solid c(border);
  backdrop-filter: blur(12px);
  transition: height $timing-med, background-color $timing-med, box-shadow $timing-med;

  &.shrink {
    height: $nav-h-sm;
    background: rgba(15,23,42,.8);
    box-shadow: 0 6px 18px rgba(0,0,0,.25);
  }

  nav {
    @include container;
    height: 100%;
    display: flex;
    align-items: center;
    gap: $space-5;
    position: relative; /* progress bar base */
  }

  .brand {
    display: flex;
    align-items: center;
    gap: $space-3;
    margin-right: auto;
    font-weight: 700;
    letter-spacing: .3px;

    i { color: c(brand2); }
    span {
      font-size: clampREM(1.05, 1.6, 1.25);
      transform: scale(var(--nav-scale));
      transform-origin: left center;
    }
  }

  ul {
    display: flex;
    gap: clamp(8px, 2vw, 24px);
    list-style: none;
    margin: 0;
    padding: 0;

    li a {
      display: inline-block;
      padding: 8px 10px;
      border-radius: $radius-sm;
      font-size: clampREM(.95, 1.4, 1.12);
      transform: scale(var(--nav-scale));
      transform-origin: center;
      transition: color $timing-fast, transform $timing-fast, background-color $timing-fast;
      color: c(muted);

      &:hover { color: c(text); transform: translateY(-1px) scale(var(--nav-scale)); }
      &.active { background: rgba(14,164,233,.798); } /* 保持只改背景，不改文字色 */
    }
  }
}

/* 阅读进度条（position indicator） */
#scroll-indicator {
  position: absolute;
  left: 0; bottom: 0;
  height: 3px; width: 0%;
  background: linear-gradient(90deg, c(brand), c(brand2));
  transition: width .1s linear;
  will-change: width;
}

// Section wrapper
section {
  @include section;
  @include container;
  display: grid;
  place-items: center;
  gap: $space-6;
}

// Hero
#hero {
  position: relative;
  min-height: calc(100vh - #{$nav-h-lg});
  display: grid;
  place-items: center;
  text-align: center;
  overflow: hidden;

  .hero-bg-video {
    position: fixed;
    inset: 0;
    width: 100vw; height: 100vh;
    object-fit: cover;
    z-index: -2;
    pointer-events: none;
    filter: brightness(.9) saturate(1.1);
  }

  .hero-content {
    @include glass;
    position: relative;
    z-index: 1;
    max-width: 900px;
    padding: $space-7;
    animation: fadeUp .8s ease both;
  }

  h1 { font-size: clampREM(2.4, 5.5, 4.2); }
  p  { font-size: clampREM(1.05, 1.6, 1.25); }

  .cta {
    display: inline-flex;
    flex-wrap: wrap;
    gap: $space-3;
    margin-top: $space-4;

    .btn {
      padding: 12px 18px;
      border-radius: $radius-md;
      border: 1px solid c(border);
      color: white;
      background: rgba(255,255,255,.06);
      transition: transform $timing-fast, background $timing-fast;

      &.primary {
        background: linear-gradient(90deg, c(brand), c(brand2));
        border-color: transparent;
      }
      &:hover { transform: translateY(-1px); background: rgba(255,255,255,.12); }
    }
  }
}

// About
#about {
  .about-container {
    display: grid;
    gap: $space-7;
    align-items: center;
    grid-template-columns: 1.2fr .8fr;

    @include respond(md) { grid-template-columns: 1fr; }
  }

  .about-text { @include glass; padding: $space-6; }
  .about-img  { @include glass; padding: $space-3;
    img { border-radius: $radius-lg; }
  }

  .about-multicol {
    column-count: 2;
    column-gap: $space-7;

    @include respond(sm) { column-count: 1; }
    p { break-inside: avoid; }
  }
}

// Experience
#experience {
  .xp-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2rem;

    @include respond(md) { grid-template-columns: repeat(2, 1fr); }
    @include respond(xs) { grid-template-columns: 1fr; }
  }

  .xp-item {
    border: 1px solid c(border);
    border-radius: $radius-lg;
    padding: 1.25rem;
    background: rgba(255,255,255,.03);
    backdrop-filter: blur(2px);
    transition: transform $timing-fast, box-shadow $timing-fast, border-color $timing-fast;

    &:hover, &:focus-within {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0,0,0,.18);
      border-color: rgba(76,175,239,.6);
    }
  }

  .xp-icon {
    display: grid;
    place-items: center;
    height: 80px;
    margin-bottom: .75rem;

    i {
      font-size: 56px;
      line-height: 1;
      color: #4cafef;
      text-shadow: 0 4px 18px rgba(76,175,239,.35);
    }
  }

  .xp-title { font-size: 1.05rem; font-weight: 700; margin: 0 0 .25rem 0; }
  .xp-desc  { margin: 0; opacity: .9; }
}

// Projects (Carousel)
#projects {
  width: 100%;

  .carousel {
    @include glass;
    position: relative;
    width: 100%;
    padding: $space-3;  /* 与其余卡片风格一致 */
    padding-bottom: 40px; /* 为圆点留空间 */
    overflow: hidden; /* 防止阴影撑宽 */
  }

  .viewport { overflow: hidden; border-radius: $radius-lg; }
  .track {
    display: flex;
    transition: transform .5s ease;
    will-change: transform;
  }

  .slide {
    min-width: 100%;
    padding: $space-6;
    display: grid;
    gap: 14px;
    background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.02));

    .meta { color: c(muted); }
    .links a { color: c(brand2); text-decoration: underline; }
  }

  button.prev,
  button.next {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 44px; height: 44px;
    border-radius: 50%;
    border: 1px solid c(border);
    background: rgba(0,0,0,.35);
    color: white;
    display: grid; place-items: center;
    cursor: pointer;
    transition: background $timing-fast, transform $timing-fast;

    &:hover { background: rgba(255,255,255,.15); transform: translateY(-50%) scale(1.04); }
  }
  button.prev { left: 10px; }
  button.next { right: 10px; }

  /* 中部居中的圆点指示器 */
  .dots {
    position: absolute;
    left: 50%;
    bottom: 12px;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    pointer-events: none;

    button {
      pointer-events: auto;
      width: 10px; height: 10px;
      border-radius: 50%;
      border: 0;
      background: rgba(255,255,255,.35);
      outline: none;
      cursor: pointer;
      opacity: .9;
      transition: transform $timing-fast, background-color $timing-fast, opacity $timing-fast;

      &.active {
        background: #fff;
        transform: scale(1.15);
      }

      &:hover, &:focus-visible {
        background: #fff;
        box-shadow: 0 0 0 3px rgba(255,255,255,.25);
      }
    }

    @media (hover: none) {
      button { width: 12px; height: 12px; }
    }
  }
}

/* ========================================
   Skills
======================================== */
#skills {
  .skills-bg { width: 100%; }

  .tag-cloud {
    list-style: none;
    margin: 0; padding: 0;
    display: flex; flex-wrap: wrap;
    gap: 10px 12px;
    justify-content: center;

    li { margin: 0; padding: 0; }

    span {
      @include glass;
      display: inline-block;
      padding: 8px 12px;
      border-radius: $radius-pill;
      font-size: clampREM(.9, 1.2, 1.05);
      line-height: 1;
      white-space: nowrap;
      border: 1px solid c(border);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
    }

    @include respond(sm) {
      gap: 8px 10px;
      span { padding: 7px 10px; }
    }
  }

  .skills-grid { display: none; }
}

/* ========================================
   Gallery（全宽固定背景面板）
======================================== */
#gallery {
  width: 100dvw;
  margin-left: calc(50% - 50dvw);
  min-height: clamp(420px, 60vh, 780px);
  padding-block: 0; /* 覆盖 section 的默认 padding */
  position: relative;
  z-index: 0;

  background-image: url('../assets/image/snow_mountain.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;

  @include respond(sm) { background-attachment: scroll; }

  .panel {
    min-height: unset;
    height: auto;
    overflow: hidden;
    display: grid;
    place-items: center;
    text-align: center;
    color: #fff;
    text-shadow: 0 2px 18px rgba(0,0,0,.5);
    border-radius: $radius-lg;
    border: 1px solid c(border);
    box-shadow: $shadow;
    padding: clamp(16px, 3vw, 32px);
    background: rgba(0,0,0,.18);
  }

  .panel > div {
    max-width: min(900px, 92%);
    margin-inline: auto;
  }
}

/* ========================================
   Video (optional)
======================================== */
#video .video-card {
  @include glass;
  padding: $space-4;

  video { width: 100%; border-radius: $radius-md; }
  .caption { margin-top: $space-2; text-align: center; }
}

// Modal (Contact + Experience)
.modal {
  position: fixed;
  inset: 0;
  display: none;
  place-items: center;
  background: rgba(0,0,0,.5);
  z-index: map-get($z, modal);

  &.open { display: grid; animation: fadeIn .2s ease; }

  .modal-content {
    @include glass;
    width: min(560px, 92vw);
    padding: 22px;
    position: relative;
    animation: scaleIn .2s ease;

    .close {
      position: absolute;
      right: 10px; top: 10px;
      font-size: 22px;
      cursor: pointer;
      color: c(muted);
      transition: color $timing-fast;

      &:hover { color: c(text); }
    }

    .socials {
      display: flex;
      gap: $space-3;
      margin-top: 10px;
      flex-wrap: wrap;

      a { display: inline-flex; align-items: center; gap: $space-2; color: c(brand2); }
    }
  }

  /* 经验详情弹窗：占据 75% 视窗（需求） */
  .modal-content.project-modal {
    width: min(1200px, 75vw);
    max-height: 75vh;
    overflow: auto;
  }
}

// Footer
footer {
  @include container;
  padding: 24px 0 64px;
  border-top: 1px solid c(border);
  color: c(muted);
  display: flex;
  gap: $space-4;
  align-items: center;
  justify-content: space-between;

  .social-icons {
    display: flex; gap: $space-3;

    a {
      width: 36px; height: 36px;
      display: grid; place-items: center;
      border-radius: $radius-sm;
      border: 1px solid c(border);
    }
  }
}

/* 保留你的 footer-content 结构（若有重复容器，可按需删改） */
.footer-content {
  @include container;
  padding: 24px 0 64px;
  border-top: 1px solid c(border);
  color: c(muted);
  display: flex;
  gap: $space-4;
  align-items: center;
  justify-content: space-between;
}

// Reveal on scroll & Keyframes
.reveal {
  opacity: 0;
  transform: translateY(14px);
  transition: opacity .6s ease, transform .6s ease;

  &.visible { opacity: 1; transform: translateY(0); }
}

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(12px); }
  to   { opacity: 1; transform: translateY(0); }
}
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes scaleIn { from { transform: scale(.96); opacity: .8; } to { transform: scale(1); opacity: 1; } }

// Responsive tweaks
@media (min-width: map-get($bp, xxl)) {
  :root { --nav-scale: 1.05; }
  #hero h1 { font-size: 4.4rem; }
}

@media (max-width: 1366px) { section { gap: 20px; } }
@media (max-width: map-get($bp, lg)) { #about .about-container { gap: 24px; } }
@media (max-width: map-get($bp, md)) { #hero .hero-content { padding: 22px; } }
@media (max-width: map-get($bp, xs)) { #navbar ul li a { padding: 8px; } }
